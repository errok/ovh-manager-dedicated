<div class="useraccount-agreements">
    <div class="page-header">
        <h1 data-translate="user_agreements_title"></h1>
    </div>
    <!-- /.page-header -->
    <div class="tab-content">
        <div data-ovh-alert="agreements_alerter"></div>
        <div class="alert"
             data-ng-class="alertType"
             data-ng-if="message">
            <button type="button"
                    class="close"
                    data-dismiss="alert"
                    aria-label="Close"
                    data-ng-click="resetMessages()"
                    title="{{ 'user_agreements_alert_close' | translate }}">
                <span aria-hidden="true">&times;</span>
            </button>
            <span data-ng-bind="message"></span>
        </div>
        <div data-ng-if="toActivate.count || (loading && loaders.toActivate)">
            <h2 data-translate="user_agreements_to_validate"></h2>
            <table class="table table-hover">
                <thead>
                    <tr>
                        <th colspan="2"
                            scope="col"
                            data-translate="user_agreements_name">
                        </th>
                    </tr>
                </thead>
                <tbody>
                    <tr data-ng-repeat="agreement in toActivate.list.results track by $index">
                        <th scope="row">
                            <a data-ui-sref="app.account.service.useraccount.agreementsDetails({
                                   id: agreement.id
                               })"
                               data-ng-bind-html="'user_agreements_agreed' | translate:{ t0: agreement.name }">
                            </a>
                        </th>
                        <td class="text-right">
                            <oui-action-menu data-align="end"
                                             data-compact>
                                <oui-action-menu-item aria-label="{{ :: 'user_agreements_accept_title' | translate:{ t0: agreement.name } }}"
                                                      data-text="{{ :: 'user_agreements_accept' | translate }}"
                                                      data-on-click="accept(agreement.id)">
                                </oui-action-menu-item>
                                <oui-action-menu-item data-text="{{ :: 'user_agreements_download_pdf' | translate }}"
                                                      href="{{ agreement.pdfUrl }}"
                                                      data-external>
                                </oui-action-menu-item>
                            </oui-action-menu>
                        </td>
                    </tr>
                </tbody>
                <tbody data-ng-if="loaders.toActivate">
                    <tr>
                        <td class="text-center"
                            colspan="2">
                            <oui-spinner data-size="s">
                            </oui-spinner>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
        <h2 data-translate="user_agreements_list_title"></h2>
        <table class="table table-hover">
            <thead>
                <tr>
                    <th scope="col"
                        data-translate="user_agreements_name">
                    </th>
                    <th scope="col"
                        data-translate="user_agreements_status">
                    </th>
                    <th colspan="2"
                        scope="col"
                        data-translate="user_agreements_date">
                    </th>
                </tr>
            </thead>
            <tbody data-ng-if="loading">
                <tr>
                    <td colspan="4"
                        class="text-center">
                        <oui-spinner data-size="s">
                        </oui-spinner>
                    </td>
                </tr>
            </tbody>
            <tbody data-ng-if="list.count === 0 && !loading">
                <tr>
                    <td colspan="4"
                        class="text-center font-italic"
                        data-translate="user_agreements_table_empty">
                    </td>
                </tr>
            </tbody>
            <tbody data-ng-if="list.count > 0 && !loading">
                <tr data-ng-repeat="agreement in list.list.results track by $index">
                    <th scope="row">
                        <a data-ui-sref="app.account.service.useraccount.agreementsDetails({
                               id: agreement.id
                           })"
                           data-ng-bind="agreement.name">
                        </a>
                    </th>
                    <td data-translate="{{ 'user_agreements_status_' + agreement.state }}"></td>
                    <td data-ng-bind="agreement.date | date:'short'"></td>
                    <td class="text-right">
                        <oui-action-menu data-align="end"
                                         data-compact>
                            <oui-action-menu-item data-text="{{ :: 'common_download_format' | translate:{ t0: 'PDF' } }}"
                                                  href="{{ agreement.pdfUrl }}"
                                                  data-external>
                            </oui-action-menu-item>
                        </oui-action-menu>
                    </td>
                </tr>
            </tbody>
        </table>
        <div data-pagination-server-side="agreementsList"
             data-pagination-server-side-function="loadAgreementsList"
             data-pagination-server-side-paginated-stuff="list"
             data-pagination-server-side-table-loading="loading">
        </div>
    </div>
    <!-- /.tab-content -->
</div>
<!-- /.useraccount-agreements -->
